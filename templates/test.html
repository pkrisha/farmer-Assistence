
{% extends "base.html" %}

{% block content %}

    
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Roboto', sans-serif;
}

body {
    background-color: #f5f5f5;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

.phone-container {
    max-width: 380px;
    width: 100%;
    margin: 20px auto;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    background: white;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.status-bar {
    background-color: #523309;
    color: white;
    padding: 15px;
    text-align: left;
    font-size: 18px;
    font-weight: bold;
    display: flex;
    align-items: center;
}

.status-bar .contact {
    margin-left: 10px;
}

.messages-container {
    flex: 1;
    padding: 15px;
    overflow-y: auto;
    background-color: #e5e5e5;
    display: flex;
    flex-direction: column;
}

.message {
    margin-bottom: 10px;
    max-width: 80%;
    padding: 10px 15px;
    border-radius: 20px;
    position: relative;
    clear: both;
    word-wrap: break-word;
}

.received {
    background-color: white;
    align-self: flex-start;
    border-bottom-left-radius: 5px;
}

.sent {
    background-color: #e1ffc7;
    align-self: flex-end;
    border-bottom-right-radius: 5px;
}

.time {
    font-size: 11px;
    color: #888;
    margin-top: 5px;
    text-align: right;
}

.input-area {
    display: flex;
    padding: 10px;
    background-color: #f5f5f5;
    border-top: 1px solid #e0e0e0;
}

.input-area input {
    flex: 1;
    padding: 12px 15px;
    border: none;
    border-radius: 20px;
    outline: none;
    background-color: white;
    margin-right: 10px;
    font-size: 16px;
}

.send-button {
    width: 45px;
    height: 45px;
    background-color: #523309;
    color: white;
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

.send-button svg {
    width: 24px;
    height: 24px;
}

.back-arrow {
    margin-right: 15px;
}

/* Previous message history */
#history-messages {
    margin-bottom: 15px;
}

/* Loading indicator */
.typing-indicator {
    align-self: flex-start;
    background-color: #e0e0e0;
    border-radius: 20px;
    padding: 12px 20px;
    margin-bottom: 10px;
    display: none;
}

.typing-dots {
    display: flex;
}

.dot {
    width: 8px;
    height: 8px;
    background-color: #777;
    border-radius: 50%;
    margin: 0 2px;
    animation: bounce 1.5s infinite;
}

.dot:nth-child(2) {
    animation-delay: 0.2s;
}

.dot:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes bounce {
    0%, 60%, 100% {
        transform: translateY(0);
    }
    30% {
        transform: translateY(-5px);
    }
}

/* Styling for asterisks in messages */
.message-content {
    white-space: pre-wrap;
}

.message-content strong {
    font-weight: bold;
}
    </style>


    <div class="phone-container">
        <div class="status-bar">
            <div class="back-arrow">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 12H5"/>
                    <path d="M12 19l-7-7 7-7"/>
                </svg>
            </div>
            <div class="contact">
                Agri_SMS üåæ
            </div>
        </div>
        
        <div class="messages-container" id="messages">
            <div id="history-messages">
                <div class="message received">
                    <div class="message-content">üëã <strong>Welcome to Agri_SMS</strong> ‚Äî Your Farm Assistant ü§ñ

<strong>You can send the following messages:</strong>
1Ô∏è‚É£ <strong>weather in &lt;city&gt;</strong> ‚Äì Get live weather updates üå¶Ô∏è
2Ô∏è‚É£ <strong>loan &lt;Loan_ID&gt;</strong> ‚Äì Check your loan status and details üí∞
3Ô∏è‚É£ <strong>help</strong> ‚Äì Show this guide again ‚ùì</div>
                    <!-- <div class="time">10:30 AM</div> -->
                </div>
            </div>
            
            <div class="typing-indicator" id="typing-indicator">
                <div class="typing-dots">
                    <div class="dot"></div>
                    <div class="dot"></div>
                    <div class="dot"></div>
                </div>
            </div>
            
            {% if reply %}
            <div class="message sent" id="user-message">
                {{ request.form.Body }}
                <div class="time">Just now</div>
            </div>
            
            <div class="message received" id="bot-response">
                <div class="message-content">{{ reply | safe }}</div>
                <div class="time">Just now</div>
            </div>
            {% endif %}
        </div>
        
        <form class="input-area" method="POST">
            <input type="text" name="Body" placeholder="Message AgriBot..." required>
            <button type="submit" class="send-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </form>
    </div>

    <script>

        document.querySelector('form').addEventListener('submit', function() {
            const typingIndicator = document.getElementById('typing-indicator');
            typingIndicator.style.display = 'block';
            
          
            const messagesContainer = document.getElementById('messages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        });
        
   
        window.onload = function() {
            const messagesContainer = document.getElementById('messages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
      
            document.querySelectorAll('.message-content').forEach(function(element) {
                element.innerHTML = element.innerHTML.replace(/\*(.*?)\*/g, '<strong>$1</strong>');
            });
        };
    </script>


{% endblock %}